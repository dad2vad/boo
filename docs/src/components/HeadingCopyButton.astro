<script>
  document.querySelectorAll('h1,h2,h3,h4,h5,h6').forEach((el) => {
    const h = el as HTMLHeadingElement
    const copyButton = document.createElement('button')

    copyButton.classList.add('copy')

    copyButton.innerText = '#'

    copyButton.ariaLabel = copyButton.title = `copy anchor to "${h.innerText}"`

    copyButton.onclick = () => {
      location.hash = `#${h.id}`
      navigator.clipboard.writeText(location.href)
    }

    h.appendChild(copyButton)
  })
</script>
<style is:global>
  button.copy:before {
    content: unset;
  }
  button.copy {
    display: inline;
    border: none;
    background: unset;
    margin: 0;
    padding: 0;
    min-width: unset;
    margin-left: 1rem;
    font-size: 1rem;
    line-height: 1rem;
    height: 1rem;
    position: relative;
    top: -0.5rem;
  }
  h1 button.copy,
  h2 button.copy {
    top: -1rem;
  }
</style>
